<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

<head>
  <head>
    <script defer src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>


    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4F8KTHDP9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-4F8KTHDP9M');
    </script>
    
    
    
    <title>Ray Peat on depression</title>
    <meta charset="utf-8">
    <meta name="description" content="Explore the wisdom of Ray Peat by topics    " />
    <meta name="dc.relation" content="https://raypeatexplained.com" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#1A94D2" />

    

    
    <link rel="stylesheet" href="../css/styles.min.css" media="screen">

    
    <link rel='shortcut icon' type='image/x-icon' href='../favicon.ico' />
    
    <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore-compat.js"></script>

    <style>
         
        .search-box {
            margin-bottom: 20px;
            text-align: center;
        }

        .search-box input {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            min-width: calc(50% - 20px);
             
        }

        .highlight {
            background-color: yellow;
             
        }
    </style>

</head>
</head>

<body>


  <header class="sticky-top">
          <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="https://raypeatexplained.com/">Ray Peat Explained</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link  " href="https://raypeatexplained.com/">Home</a>              </li>

              
              
          </div>
        </div>
      </nav>

  </header>
  <div class="container-fluid">
    <main>
      


<div class="container pb-5 mt-4">
  <h1 class="mb-3" style="text-transform: capitalize;">Ray Peat on depression</h1>
  
  
  
  
  <div class="search-box">
    <button class="btn btn-primary" id="sort-by-popularity">Sort by popularity</button>

    <input type="text" id="quoteSearch" placeholder="Search quotes...">
  </div>

 

  


  <div id="quotesContainer"> 
  <p>
<div class="quote"  data-upvotes="0" data-quote-id="84522666195494906655676728502223999215">
    <div id='84522666195494906655676728502223999215' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Blood Glucose&#39;s Role in Cortisone Formation</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"the basic signal which causes cortisone to be formed is a drop in the blood glucose level. The increased energy requirement of any stress tends to cause the blood sugar to fall slightly, but hypothyroidism itself tends to depress blood sugar."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- Generative Energy  Restoring The Wholeness Of Life</p>
        <button class="upvote-button" onclick="upvote('84522666195494906655676728502223999215')">Upvote</button>
          <span class="upvote-counter" id="84522666195494906655676728502223999215-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="94500990312697433411281710403350728706">
    <div id='94500990312697433411281710403350728706' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Lithium&#39;s Treatment for Mood Disorders</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Lithium has been used for many years to treat various mood disorders, including anxiety and depression, and it reduces activation of the NMDA system, possibly by binding ammonia."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- January 2017 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('94500990312697433411281710403350728706')">Upvote</button>
          <span class="upvote-counter" id="94500990312697433411281710403350728706-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="323037011501087445999593506655836625546">
    <div id='323037011501087445999593506655836625546' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Hypothyroidism, Stress, and Related Physiological Complications</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Hypothyroid people, with low production of CO2, are very susceptible to stress-induced hyperventilation, and they are often in a state of physiological hyperventilation. They are susceptible to over-production of ammonia (De Nardo, et al., 1999; Marti, et al., 1988) and lactate (Zarzeczny, et al., 1996), and to psychosis, especially depression and mania."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- July 2017 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('323037011501087445999593506655836625546')">Upvote</button>
          <span class="upvote-counter" id="323037011501087445999593506655836625546-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="204746232735334241622659403581400533559">
    <div id='204746232735334241622659403581400533559' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Complex Mechanisms in Pseudohypoxic State Perpetuation</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"There are several important mechanisms that are involved in perpetuating a pseudohypoxic state, and they can operate in a single tissue or organ, as well as in a generalized way throughout the organism. The thing that is often overlooked is the coherent overlapping interaction of the structural sulfhydryl redox system (-SH, -SS-), the redox regulation of gene expression, the glycolytic and oxidative energy metabolisms, regulation of pH and ionic selectivity, osmolarity, and solvent properties, especially the hydroephobic/hydrophilic balance."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- July 2017 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('204746232735334241622659403581400533559')">Upvote</button>
          <span class="upvote-counter" id="204746232735334241622659403581400533559-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="291048734174283218790697670148145277638">
    <div id='291048734174283218790697670148145277638' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Depersonalization in Scientific Writing: A Propaganda Technique</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The style of writing in science journals is explicitly intended to depersonalize language, to give the impression of objectivity. That is a propaganda technique, that contributes nothing to scientific objectivity."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- July 2018 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('291048734174283218790697670148145277638')">Upvote</button>
          <span class="upvote-counter" id="291048734174283218790697670148145277638-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="166791871019872580033766865147102976396">
    <div id='166791871019872580033766865147102976396' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Lipolysis Intensity and Restorative Sleep Interference</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The intensity of lipolysis during the night is decreased during the most restorative deep sleep, but the free fatty acids themselves, by blocking oxidation of glucose to carbon dioxide, tend to increase lactate and to depress glucose metabolism, creating an inflammatory and excitatory state that interferes with deep sleep."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- March 2018 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('166791871019872580033766865147102976396')">Upvote</button>
          <span class="upvote-counter" id="166791871019872580033766865147102976396-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="327159632466272016849832239438835610916">
    <div id='327159632466272016849832239438835610916' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">The Pervasive Role of Inflammation in Degeneration</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Inflammation is involved in the chronic degenerative conditions, especially atrophy and cancer, and even in depression"</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- March 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('327159632466272016849832239438835610916')">Upvote</button>
          <span class="upvote-counter" id="327159632466272016849832239438835610916-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="281906805688361677606050344878802638872">
    <div id='281906805688361677606050344878802638872' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">20th Century Philosophers&#39; Quest for Ideal Language</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The hope of constructing an ideal language that was so important to philosophers early in the 20th century followed from an assumption that language is an instrument of knowing, and that logic and mathematics are ways of ordering that knowledge, and expressing it in ways that can be proved."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- May 2017 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('281906805688361677606050344878802638872')">Upvote</button>
          <span class="upvote-counter" id="281906805688361677606050344878802638872-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="111307282819622940504232566954430229706">
    <div id='111307282819622940504232566954430229706' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Animal Communication Through Body Language</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"All animals use body language to communicate—when a facial expression or gesture or stance is perceived, the ability to mimic means that the feeling behind the gesture is simultaneously perceived."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- May 2018 - Ray Peats Newsletter</p>
        <button class="upvote-button" onclick="upvote('111307282819622940504232566954430229706')">Upvote</button>
          <span class="upvote-counter" id="111307282819622940504232566954430229706-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="5929186014667274907768622329745638542">
    <div id='5929186014667274907768622329745638542' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Estrogen, Serotonin, and Drug Company Manipulation</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Drug company manipulation of information about estrogen has been more extreme than its treatment of serotonin. Activated by stress, along with serotonin, it is one of the major activators of the corticotropin release hormone, CRH, which activates the pituitary and adrenal glands, and promotes inflammation, and is a major factor in PPD (Glynn and Sandman, 29014, HahnHolbrook, 2016), as well as in other types of depression, and aging, and Alzheimer’s disease."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- May 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('5929186014667274907768622329745638542')">Upvote</button>
          <span class="upvote-counter" id="5929186014667274907768622329745638542-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="289064322687376399102871190303489605578">
    <div id='289064322687376399102871190303489605578' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Estrogen, Serotonin, and Female-Predominant Diseases</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"If it weren’t for the advertising culture, it would probably be generally recognized that both estrogen and serotonin have important roles in causing depression, migraine, and Alzheimer’s disease, all of which occur much more often in women than in men."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- May 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('289064322687376399102871190303489605578')">Upvote</button>
          <span class="upvote-counter" id="289064322687376399102871190303489605578-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="134143842754975401604989301913509661418">
    <div id='134143842754975401604989301913509661418' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Postpartum Cholesterol and Mental Health</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Several studies have observed an association of lower postpartum cholesterol with symptoms of anxiety and depression"</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- May 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('134143842754975401604989301913509661418')">Upvote</button>
          <span class="upvote-counter" id="134143842754975401604989301913509661418-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="160377536803024827009731551607493361119">
    <div id='160377536803024827009731551607493361119' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Postpartum Progesterone and Brain Health</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"With insufficient cholesterol, the normally high postpartum concentration of progesterone isn’t likely to be maintained, and instead of brain restoration, the various pro-inflammatory effects of serotonin and estrogen will predominate, with effects such as depression, joint pain, anxiety, and brain edema."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- May 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('160377536803024827009731551607493361119')">Upvote</button>
          <span class="upvote-counter" id="160377536803024827009731551607493361119-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="277772700888788250374950461068156020983">
    <div id='277772700888788250374950461068156020983' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Low Cholesterol and Mental Health Implications</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Low serum cholesterol has been associated with depression, suicide, violence, and increased cancer mortality. Since statins enter the brain, and inhibit the synthesis of cholesterol there, decreased mitochondrial function is undoubtedly a factor in the mental side effects that they can produce."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- November 2018 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('277772700888788250374950461068156020983')">Upvote</button>
          <span class="upvote-counter" id="277772700888788250374950461068156020983-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="266044726643441437258731347570315145788">
    <div id='266044726643441437258731347570315145788' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Bodily Experiences Influencing Vitality and Physiology</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Our bodies are constantly having experiences, and generalizing from them in the way they respond; these generalized responses can limit or expand our vitality. These generalizations are expressed in our anatomy, physiology, and ecosystems, with changes in immunity, metabolism, gene expression, and behavior."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2017 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('266044726643441437258731347570315145788')">Upvote</button>
          <span class="upvote-counter" id="266044726643441437258731347570315145788-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="32453773385988400959936138534307295857">
    <div id='32453773385988400959936138534307295857' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Parathyroid Hormone Reduction Linked to Obesity and Related Issues</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The reduction of parathyroid hormone by increased calcium and vitamin D is closely related to reduced obesity, and to the health problems associated with obesity—hypertension, insulin resistance, heart arrhythmias, depression, and various inflammatory conditions."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2017 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('32453773385988400959936138534307295857')">Upvote</button>
          <span class="upvote-counter" id="32453773385988400959936138534307295857-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="83279674920248427457487146244783349373">
    <div id='83279674920248427457487146244783349373' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">BBB and Cellular Stress: Evidence in Blood</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The Blood Brain Barrier, BBB, has sometimes been treated as something unique, but it’s just a special case of the cellular resistance that exists everywhere. For example, after intense exercise that produces fatigue and damage to muscles, a unique brain protein, S100B, that is considered a crucial part of the BBB, can be found in the blood stream. The exchange of substances, even proteins and nucleic acids, between cells and their environment, increases during stress. The detection of substances such as S100B in the blood is now recognized as evidence of depression and brain damage"</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('83279674920248427457487146244783349373')">Upvote</button>
          <span class="upvote-counter" id="83279674920248427457487146244783349373-count">0</span> upvotes
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>
</p>

  </div>  
</div>


    </main>
    <footer>
      <footer class="footer fixed-bottom bg-dark">

    

  

  
  
  <script src="../js/bundle.min.js" defer></script>
      <script src="../js/main.f8356cbfc3b51bb24c286205b62461b46aaa5a219dac170a24f1692c6ff4154a.js" integrity="sha256-&#43;DVsv8O1G7JMKGIFtiRhtGqqWiGdrBcKJPFpLG/0FUo=" crossorigin="anonymous"></script>
</footer>
    </footer>
  </div>

  <script defer type="module">
    
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js';
    import { getFirestore, doc, onSnapshot, setDoc, updateDoc, increment, getDocs, collection, serverTimestamp, addDoc } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-firestore.js';
    import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-auth.js';


    const firebaseConfig = {
      apiKey: "AIzaSyBNTOHPQHCasjzKwje2P78-q6p1hsXQkW4",
      authDomain: "ray-peat-explained.firebaseapp.com",
      projectId: "ray-peat-explained",
      storageBucket: "ray-peat-explained.appspot.com",
      messagingSenderId: "791071522728",
      appId: "1:791071522728:web:3df2e0f7e4c0b66d4a679d"
    };


    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    async function signInAnonymouslyAndUpvote(upvote_id) {
      try {
        
        const userCredential = await signInAnonymously(auth);
        const user = userCredential.user;

        
        if (user) {
          console.log(`User is signed in anonymously with uid: ${user.uid}`);

          
          const upvoteData = {
            anonymousUserId: user.uid,
            upvote_id: upvote_id,
            timeOfUpvote: serverTimestamp(),
          };

          
          const docRef = await addDoc(collection(db, "upvotes"), upvoteData);
          console.log("Document written with ID: ", docRef.id);
        } else {
          console.log("User sign-in failed");
        }
      } catch (error) {
        const errorCode = error.code;
        const errorMessage = error.message;
        console.error(`Error code: ${errorCode}, Message: ${errorMessage}`);
      }
    }

    
    function setUpQuoteListener(quoteId) {
      const quoteRef = doc(db, "quotes", quoteId);

      onSnapshot(quoteRef, (docSnapshot) => {
        const upvotesSpan = document.getElementById(`${quoteId}-count`);
        if (docSnapshot.exists()) {
          upvotesSpan.textContent = docSnapshot.data().upvotes;
        } else {
          
          setDoc(quoteRef, { upvotes: 0 })
            .then(() => { upvotesSpan.textContent = "0"; })
            .catch((error) => {
              console.error("Error creating document: ", error);
            });
        }
      });
    }

    
    function upvote(quoteId) {
      const quoteRef = doc(db, "quotes", quoteId);

      
      updateDoc(quoteRef, {
        upvotes: increment(1)
      }).catch((error) => {
        console.error("Error updating document: ", error);
      });

      signInAnonymouslyAndUpvote(quoteId).catch((error) => {
        console.error("Error updating document II: ", error);
      });

    }

    
    window.upvote = upvote;

    
    document.addEventListener('DOMContentLoaded', () => {
      
      const quoteContainers = document.querySelectorAll('.quote-container');

      
      quoteContainers.forEach(container => {
        const quoteId = container.id;
        setUpQuoteListener(quoteId);
      });
    });

    document.getElementById("sort-by-popularity").addEventListener('click', async () => {
      try {
        
        const querySnapshot = await getDocs(collection(db, 'quotes'));
        const upvotesMap = new Map();  

        querySnapshot.forEach(doc => {
          
          upvotesMap.set(doc.id, doc.data().upvotes);
        });

        
        const quoteElems = document.querySelectorAll('.quote');

        
        quoteElems.forEach(quoteElem => {
          const quoteId = quoteElem.getAttribute('data-quote-id');
          const upvotes = upvotesMap.get(quoteId) || 0; 
          quoteElem.setAttribute('data-upvotes', upvotes);
        });

        
        const quoteArray = Array.from(quoteElems);
        quoteArray.sort((a, b) => {
          return b.getAttribute('data-upvotes') - a.getAttribute('data-upvotes');
        });

        
        const quotesContainer = document.getElementById('quotesContainer');
        quotesContainer.innerHTML = ''; 

        
        quoteArray.forEach(quote => {
          quotesContainer.appendChild(quote);
        });
      } catch (err) {
        console.error('Error fetching upvotes: ', err);
      }
    });

    
  </script>

</body>

</html>