<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

<head>
  <head>
    <script defer src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>


    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4F8KTHDP9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-4F8KTHDP9M');
    </script>
    
    
    
    <title>Ray Peat on parathyroid hormone</title>
    <meta charset="utf-8">
    <meta name="description" content="Explore the wisdom of Ray Peat by topics    " />
    <meta name="dc.relation" content="https://raypeatexplained.com" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#1A94D2" />

    

    
    <link rel="stylesheet" href="../css/styles.min.css" media="screen">

    
    <link rel='shortcut icon' type='image/x-icon' href='../favicon.ico' />
    
    <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore-compat.js"></script>

    <style>
         
        .search-box {
            margin-bottom: 20px;
            text-align: center;
        }

        .search-box input {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            min-width: calc(50% - 20px);
             
        }

        .highlight {
            background-color: yellow;
             
        }
    </style>

</head>
</head>

<body>


  <header class="">
          <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="https://raypeatexplained.com/">Ray Peat Explained</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link  " href="https://raypeatexplained.com/">Home</a>              </li>

              
              

            
            
            <li class="nav-item">
              <a class='nav-link'
                href="https://twitter.com/bioenergy_space" target="_blank">
                <b>Find out more on</b>
                <img src="../logo-black_hua600c2e15e1e097edc626e67450d6438_102327_20x0_resize_box_3.png" alt="Description" style="vertical-align: middle;">
                 
              </a>
            </li>
          </div>
        </div>
      </nav>

  </header>
  <div class="container-fluid">
    <main>
      


<div class="container pb-5 mt-4">
  <h1 class="mb-3" style="text-transform: capitalize;">Ray Peat on parathyroid hormone</h1>
  
  
  
  
  <div class="search-box">
    <button class="btn btn-primary" id="sort-by-popularity">Sort by popularity</button>

    <input type="text" id="quoteSearch" placeholder="Search quotes...">
  </div>

 

  


  <div id="quotesContainer"> 
  <p>
<div class="quote"  data-upvotes="0" data-quote-id="30540939412014254401264129884522373881">
    <div id='30540939412014254401264129884522373881' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Parathyroid Hormone&#39;s Role and Effects in Aging</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Phosphate, which predominates in grains, beans, nuts, meats, and fish, increases our production of parathyroid hormone, while calcium and magnesium inhibit its production. This hormone, which increases with age, suppresses immunity, and in excess it causes insomnia, seizures, dementia, psychosis, cancer, heart disease, respiratory distress and pulmonary hypertension, osteoporosis, sarcopenia, histamine release, inflammation and soft tissue calcification, and many other problems."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2017 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('30540939412014254401264129884522373881')">Upvote</button>
          <span class="upvote-counter" id="30540939412014254401264129884522373881-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('30540939412014254401264129884522373881');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="203765030733671705156982177032498027548">
    <div id='203765030733671705156982177032498027548' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Milk&#39;s Influence on Parathyroid Hormone and Optimal Levels</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Drinking milk lowers parathyroid hormone, relative to the diets that chronically stimulate its production. There has been very little attention given to the optimal level of parathyroid hormone, as opposed to the normal range."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2017 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('203765030733671705156982177032498027548')">Upvote</button>
          <span class="upvote-counter" id="203765030733671705156982177032498027548-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('203765030733671705156982177032498027548');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="35275618438494586298524901929547179272">
    <div id='35275618438494586298524901929547179272' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Effects of Parathyroid Hormone Increase on Body Tissues</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"When vitamin D or calcium is deficient, or when phosphate is excessive, and in hypoglycemia and stress (Ljunghall, et al., 1984), parathyroid hormone increases. This can lead to softening of bones, and hardening of soft tissues, especially arteries, sometimes brain, skin and other organs. Parathyroid hormone increases blood pressure, even before the calcium stiffening is detected."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2017 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('35275618438494586298524901929547179272')">Upvote</button>
          <span class="upvote-counter" id="35275618438494586298524901929547179272-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('35275618438494586298524901929547179272');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="142427203838652090569200931406392475904">
    <div id='142427203838652090569200931406392475904' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Nighttime Parathyroid Hormone Activity and Calcium Loss</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"During the night, parathyroid hormone usually rises (Radjaipour 1986; Logue 1989, 1990; Fraser, 1998), and especially during aging, this causes a significant loss of calcium from the bones. Having a large part of the day’s calcium at bedtime reduces the nocturnal rise of PTH and calcium loss from bones"</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2017 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('142427203838652090569200931406392475904')">Upvote</button>
          <span class="upvote-counter" id="142427203838652090569200931406392475904-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('142427203838652090569200931406392475904');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="32453773385988400959936138534307295857">
    <div id='32453773385988400959936138534307295857' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Parathyroid Hormone Reduction Linked to Obesity and Related Issues</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The reduction of parathyroid hormone by increased calcium and vitamin D is closely related to reduced obesity, and to the health problems associated with obesity—hypertension, insulin resistance, heart arrhythmias, depression, and various inflammatory conditions."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2017 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('32453773385988400959936138534307295857')">Upvote</button>
          <span class="upvote-counter" id="32453773385988400959936138534307295857-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('32453773385988400959936138534307295857');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="249316001626179982993706171501341102478">
    <div id='249316001626179982993706171501341102478' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Parathyroid Hormone&#39;s Effect on Hair Loss and Mast Cells</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"In vitro experiments with hair follicles show that parathyroid hormone ends the growth cycle. Prostaglandin D2, associated with hair loss, is released from mast cells, and parathyroid hormone is an activator of mast cell degranulation. Hair growth has a 24 hour cycle, and the long cycle of hair shedding and renewal seems to be regulated by the genes involved in the daily cycle (Lin, et al., 2009). It’s possible that the daily cycle of parathyroid hormone is responsible for progressive hair loss,"</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2017 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('249316001626179982993706171501341102478')">Upvote</button>
          <span class="upvote-counter" id="249316001626179982993706171501341102478-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('249316001626179982993706171501341102478');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="4529729320863026690435099893084146076">
    <div id='4529729320863026690435099893084146076' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Progesterone and Vitamin D in Nerve Function Recovery</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Studies of progesterone’s effects on recovery of nerve function after traumatic brain damage have found that vitamin D increases its effectiveness. By improving calcium homeostasis, opposing the effects of the parathyroid hormone which activates calcium channels, vitamin D (25-hydroxycholecalciferol) is coming to be considered a neurosteroid (Groves, et al., 2014; Gezen-Ak and Dursun, 2019), as well as an essential factor in immunity"</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- May 2020 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('4529729320863026690435099893084146076')">Upvote</button>
          <span class="upvote-counter" id="4529729320863026690435099893084146076-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('4529729320863026690435099893084146076');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="164013452849573889778746710074236393838">
    <div id='164013452849573889778746710074236393838' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Stress Hormones&#39; Impact on Mitochondria</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The levels of aldosterone and parathyroid hormone are increased by stress, with serotonin acting on the adrenal cortex and the parathyroid gland to increase their secretion. All three of those hormones act on the mitochondria to lower oxidative energy production."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- May 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('164013452849573889778746710074236393838')">Upvote</button>
          <span class="upvote-counter" id="164013452849573889778746710074236393838-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('164013452849573889778746710074236393838');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="274221324826441759289501533902476230615">
    <div id='274221324826441759289501533902476230615' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Diet&#39;s Influence on Hormone Secretion</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Increasing the amount of sodium and calcium (and vitamin D, which also helps to lower parathyroid hormone and aldosterone) in the diet can lower the secretion of aldosterone and parathyroid hormone, with a resulting increasing in oxidative energy production."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- May 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('274221324826441759289501533902476230615')">Upvote</button>
          <span class="upvote-counter" id="274221324826441759289501533902476230615-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('274221324826441759289501533902476230615');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="6553284565678470109585488331934077567">
    <div id='6553284565678470109585488331934077567' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Factors for Healthier Pregnancies and Postpartum Life</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"the most important factors that can be optimized with existing resources. Healthier pregnancies will result in healthier and happier postpartum life. Some of these factors would be sunlight, vitamin D, milk, cheese, eggs, fruits and well cooked vegetables, fibrous foods, and optimizing thyroid function and pregnenolone and progesterone (which support mitochondrial function, protecting against aldosterone, parathyroid hormone, excess serotonin, CRK, and cortisol, besides increasing allopregnanolone), and using the safest antiinflammatory and antiserotonin drugs, such as aspirin and cyproheptadine, when they are needed."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- May 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('6553284565678470109585488331934077567')">Upvote</button>
          <span class="upvote-counter" id="6553284565678470109585488331934077567-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('6553284565678470109585488331934077567');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="8302536931149143529612272598515965440">
    <div id='8302536931149143529612272598515965440' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Oxidative Processes and Enzyme Regulation Factors</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The oxidative processes that support purposive, creative functioning of the organism, optimize CO2 by inhibiting carbonic anhydrase; this enzyme is inhibited by thyroid hormone T3, progesterone, urea, caffeine, antipsychotic drugs, and aspirin. Agents that tend to cause reversion to the primitive anaerobic energy production activate the enzyme—serotonin, tryptophan, cysteine, histamine, estrogen, aldosterone, HIF, SSRIs, angiotensin, and parathyroid hormone, for example."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- March 2020 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('8302536931149143529612272598515965440')">Upvote</button>
          <span class="upvote-counter" id="8302536931149143529612272598515965440-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('8302536931149143529612272598515965440');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="214980124986731274897254645082020616665">
    <div id='214980124986731274897254645082020616665' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Snacks as a Means to Support Restorative Sleep and Brain Health</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Using snacks to minimize the nocturnal increase of free fatty acids and hypoglycemia is an effective way to support restorative sleep, and to retard the brain-aging effects of the accumulation of the unstable fatty acids. Calcium and vitamin D, sufficient to keep parathyroid hormone low, contribute to that process."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- March 2018 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('214980124986731274897254645082020616665')">Upvote</button>
          <span class="upvote-counter" id="214980124986731274897254645082020616665-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('214980124986731274897254645082020616665');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="94526109592634170474616209071593479763">
    <div id='94526109592634170474616209071593479763' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Parathyroid Hormone Studies and Mineral Interchangeability</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"About 88 years ago, W. K. Koch (who is known for his cancer therapy) studied the parathyroid hormone and its relation to tetany (prolonged muscle contraction) and convulsions, and was able to demonstrate that the major minerals, sodium, potassium, magnesium, and calcium are to some extent interchangeable in alleviating the tetany and convulsions produced by removal of the parathyroid gland, though magnesium was the most effective."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- 1999 - December- Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('94526109592634170474616209071593479763')">Upvote</button>
          <span class="upvote-counter" id="94526109592634170474616209071593479763-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('94526109592634170474616209071593479763');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="250020927543135565352241968705453389992">
    <div id='250020927543135565352241968705453389992' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Carbon Dioxide&#39;s Crucial Regulation of Water, Proteins, and Minerals</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Water, proteins, oxygen, and minerals, are all crucially regulated by carbon dioxide. The enzyme, Garbonic anhydrase,  which is regulated by hormones (including the parathyroid hormone) and nerves, accelerates the interchange between carbon dioxide and bicarbonate, each of which has special functions. Bicarbonate is more soluble in water, but carbon dioxide is more soluble in living substance and fats."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- 1999 - December- Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('250020927543135565352241968705453389992')">Upvote</button>
          <span class="upvote-counter" id="250020927543135565352241968705453389992-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('250020927543135565352241968705453389992');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>
</p>

  </div>  
</div>


    </main>
    <footer>
      <footer class="footer fixed-bottom bg-dark">

    

  

  
  
  <script src="../js/bundle.min.js" defer></script>
      <script src="../js/main.f8356cbfc3b51bb24c286205b62461b46aaa5a219dac170a24f1692c6ff4154a.js" integrity="sha256-&#43;DVsv8O1G7JMKGIFtiRhtGqqWiGdrBcKJPFpLG/0FUo=" crossorigin="anonymous"></script>
</footer>
    </footer>
  </div>

  <script defer type="module">
    
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js';
    import { getFirestore, doc, onSnapshot, setDoc, updateDoc, increment, getDocs, collection, serverTimestamp, addDoc } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-firestore.js';
    import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-auth.js';


    const firebaseConfig = {
      apiKey: "AIzaSyBNTOHPQHCasjzKwje2P78-q6p1hsXQkW4",
      authDomain: "ray-peat-explained.firebaseapp.com",
      projectId: "ray-peat-explained",
      storageBucket: "ray-peat-explained.appspot.com",
      messagingSenderId: "791071522728",
      appId: "1:791071522728:web:3df2e0f7e4c0b66d4a679d"
    };


    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    async function signInAnonymouslyAndUpvote(upvote_id) {
      try {
        
        const userCredential = await signInAnonymously(auth);
        const user = userCredential.user;

        
        if (user) {
          console.log(`User is signed in anonymously with uid: ${user.uid}`);

          
          const upvoteData = {
            anonymousUserId: user.uid,
            upvote_id: upvote_id,
            timeOfUpvote: serverTimestamp(),
          };

          
          const docRef = await addDoc(collection(db, "upvotes"), upvoteData);
          console.log("Document written with ID: ", docRef.id);
        } else {
          console.log("User sign-in failed");
        }
      } catch (error) {
        const errorCode = error.code;
        const errorMessage = error.message;
        console.error(`Error code: ${errorCode}, Message: ${errorMessage}`);
      }
    }

    
    function setUpQuoteListener(quoteId) {
      const quoteRef = doc(db, "quotes", quoteId);

      onSnapshot(quoteRef, (docSnapshot) => {
        const upvotesSpan = document.getElementById(`${quoteId}-count`);
        if (docSnapshot.exists()) {
          upvotesSpan.textContent = docSnapshot.data().upvotes;
        } else {
          
          setDoc(quoteRef, { upvotes: 0 })
            .then(() => { upvotesSpan.textContent = "0"; })
            .catch((error) => {
              console.error("Error creating document: ", error);
            });
        }
      });
    }

    
    function upvote(quoteId) {
      const quoteRef = doc(db, "quotes", quoteId);

      
      updateDoc(quoteRef, {
        upvotes: increment(1)
      }).catch((error) => {
        console.error("Error updating document: ", error);
      });

      signInAnonymouslyAndUpvote(quoteId).catch((error) => {
        console.error("Error updating document II: ", error);
      });

    }

    
    window.upvote = upvote;

    
    document.addEventListener('DOMContentLoaded', () => {
      
      const quoteContainers = document.querySelectorAll('.quote-container');

      
      quoteContainers.forEach(container => {
        const quoteId = container.id;
        setUpQuoteListener(quoteId);
      });
    });

    document.getElementById("sort-by-popularity").addEventListener('click', async () => {
      try {
        
        const querySnapshot = await getDocs(collection(db, 'quotes'));
        const upvotesMap = new Map();  

        querySnapshot.forEach(doc => {
          
          upvotesMap.set(doc.id, doc.data().upvotes);
        });

        
        const quoteElems = document.querySelectorAll('.quote');

        
        quoteElems.forEach(quoteElem => {
          const quoteId = quoteElem.getAttribute('data-quote-id');
          const upvotes = upvotesMap.get(quoteId) || 0; 
          quoteElem.setAttribute('data-upvotes', upvotes);
        });

        
        const quoteArray = Array.from(quoteElems);
        quoteArray.sort((a, b) => {
          return b.getAttribute('data-upvotes') - a.getAttribute('data-upvotes');
        });

        
        const quotesContainer = document.getElementById('quotesContainer');
        quotesContainer.innerHTML = ''; 

        
        quoteArray.forEach(quote => {
          quotesContainer.appendChild(quote);
        });
      } catch (err) {
        console.error('Error fetching upvotes: ', err);
      }
    });

    window.copyLinkToClipboard = function copyLinkToClipboard(id) {
      
      const urlWithHash = `${window.location.href.split('#')[0]}#${id}`;
    
      
      navigator.clipboard.writeText(urlWithHash).then(() => {
        
      }).catch(err => {
        console.error("Could not copy text: ", err);
      });
    }

    window.highlightDiv=  function highlightDiv(hash) {
      
      document.querySelectorAll('.highlight-quote').forEach((el) => {
        el.classList.remove('highlight-quote');
      });
    
      
      if (hash !== '') {
        const id = hash.replace('#', '');
        const divToHighlight = document.getElementById(id);
        if (divToHighlight) {
          divToHighlight.classList.add('highlight-quote');
          console.log("Quote selected")
    
          
          divToHighlight.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      }
    }
    
    
    window.addEventListener('hashchange', () => window.highlightDiv(window.location.hash));
    window.addEventListener('DOMContentLoaded', () => window.highlightDiv(window.location.hash));
    
  </script>

</body>

</html>