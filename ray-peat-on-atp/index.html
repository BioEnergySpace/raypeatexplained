<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

<head>
  <head>
    <script defer src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>


    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4F8KTHDP9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-4F8KTHDP9M');
    </script>
    
    
    
    <title>Ray Peat on ATP</title>
    <meta charset="utf-8">
    <meta name="description" content="Explore the wisdom of Ray Peat by topics    " />
    <meta name="dc.relation" content="https://raypeatexplained.com" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#1A94D2" />

    

    
    <link rel="stylesheet" href="../css/styles.min.css" media="screen">

    
    <link rel='shortcut icon' type='image/x-icon' href='../favicon.ico' />
    
    <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore-compat.js"></script>

    <style>
         
        .search-box {
            margin-bottom: 20px;
            text-align: center;
        }

        .search-box input {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            min-width: calc(50% - 20px);
             
        }

        .highlight {
            background-color: yellow;
             
        }
    </style>

</head>
</head>

<body>


  <header class="">
          <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="https://raypeatexplained.com/">Ray Peat Explained</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link  " href="https://raypeatexplained.com/">Home</a>              </li>

              
              
          </div>
        </div>
      </nav>

  </header>
  <div class="container-fluid">
    <main>
      


<div class="container pb-5 mt-4">
  <h1 class="mb-3" style="text-transform: capitalize;">Ray Peat on ATP</h1>
  
  
  
  
  <div class="search-box">
    <button class="btn btn-primary" id="sort-by-popularity">Sort by popularity</button>

    <input type="text" id="quoteSearch" placeholder="Search quotes...">
  </div>

 

  


  <div id="quotesContainer"> 
  <p>
<div class="quote"  data-upvotes="0" data-quote-id="170941206633685607633525436977185494569">
    <div id='170941206633685607633525436977185494569' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Thyroid&#39;s Impact on Caloric Needs and Glucose Regulation</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"In my teens and twenties, I needed about 8000 calories per day when I was physically active, about 4000 to 5000 when I was sedentary, but after I took thyroid, I needed only about half as many calories. Thyroid is the basic regulator of blood glucose, and it causes it to be fully oxidized for energy, so that it produces ATP efficiently, on relatively few calories."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- Email Response by Ray Peat</p>
        <button class="upvote-button" onclick="upvote('170941206633685607633525436977185494569')">Upvote</button>
          <span class="upvote-counter" id="170941206633685607633525436977185494569-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('170941206633685607633525436977185494569');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="260877852811232118882834605658243302981">
    <div id='260877852811232118882834605658243302981' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Progesterone Stabilizes Cells, Enhances Metabolic Functions</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Besides directly stabilizing the internal structures of the cell, progesterone increases the ATP concentration and oxygen consumption, decreases excitatory systems and numerous inflammation-related processes, decreases intracellular calcium concentration, and increases the use of glucose, leading to increased carbon dioxide production, as well as adjusting breathing and pH."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- January 2018 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('260877852811232118882834605658243302981')">Upvote</button>
          <span class="upvote-counter" id="260877852811232118882834605658243302981-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('260877852811232118882834605658243302981');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="155464662150529633619652298936688336272">
    <div id='155464662150529633619652298936688336272' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Cell Organization and Energy&#39;s Impact on Protein Solubility</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Many of the new observations related to seeing cells as self-organizing coacervate systems are reminiscent of Gilbert Ling’s observations. For example, ATP increases the solubility of proteins (Patel, et al., 2017), and when energy is depleted, some proteins come out of solution, forming membrane-less organelles, filaments, and granules."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- January 2021 - Ray Peat&#39;s Newsletter  </p>
        <button class="upvote-button" onclick="upvote('155464662150529633619652298936688336272')">Upvote</button>
          <span class="upvote-counter" id="155464662150529633619652298936688336272-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('155464662150529633619652298936688336272');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="36218308132394811880000804829612727205">
    <div id='36218308132394811880000804829612727205' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">ATP&#39;s Electron-Withdrawing Role Versus Bond Energy</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Gilbert Ling’s work shows that it’s the electron-withdrawing effect of ATP that explains its effects, rather than its internal bond energy."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- July 2016  - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('36218308132394811880000804829612727205')">Upvote</button>
          <span class="upvote-counter" id="36218308132394811880000804829612727205-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('36218308132394811880000804829612727205');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="329795785586246968475585790134663550460">
    <div id='329795785586246968475585790134663550460' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">ATP Release, Inflammatory Factors, and Sleep Rhythms</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"When cells are excited, they release some ATP into their local surroundings, where it signals fatigue or injury, activating the formation of inflammatory factors such as TNF-alpha, which promote the sleep rhythm."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- March 2018 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('329795785586246968475585790134663550460')">Upvote</button>
          <span class="upvote-counter" id="329795785586246968475585790134663550460-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('329795785586246968475585790134663550460');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="227275304006104270304778172840674770338">
    <div id='227275304006104270304778172840674770338' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">High-Energy Brain States and Muscle ATP Content</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The electrical and metabolic properties of this high energy resting state of the brain can be seen in a healthy skeletal muscle, which has a high ATP content, and relaxes immediately after stimulation and contraction. If the ATP is depleted by prolonged intense stimulation, or if it isn’t replenished quickly enough, because of hypothyroidism, the relaxation is very slow, leading to cramping."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- March 2018 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('227275304006104270304778172840674770338')">Upvote</button>
          <span class="upvote-counter" id="227275304006104270304778172840674770338-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('227275304006104270304778172840674770338');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="146541738781731051178082870089199224532">
    <div id='146541738781731051178082870089199224532' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Active Transport and Role of ATP in Cells</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The membrane theory says that the process of concentrating a substance against its gradient is active transport, and requires the use of ATP. Experiments by Ling and others showed that the energy metabolism of cells could be poisoned so that no ATP was being produced, but that cells were able to maintain their ionic gradient, although sodium was free to diffuse into the cell, through the membrane. All the ATP has to do is to be present, passively occupying its place in the cell."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- March 2020 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('146541738781731051178082870089199224532')">Upvote</button>
          <span class="upvote-counter" id="146541738781731051178082870089199224532-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('146541738781731051178082870089199224532');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="57300442115080407133202307056766732383">
    <div id='57300442115080407133202307056766732383' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Ling&#39;s Perception of ATP Bond Energy</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Since Ling didn’t imagine that ATP bond energy was being consumed constantly to run membrane sodium pumps, he wasn’t concerned with any energy that might be released by hydrolyzing that bond. He, like Albert Szent-Gyorgyi, was aware that the ATP molecule adsorbs with considerable energy to protein molecules, and that its presence governs the shape of the protein molecule."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- March 2020 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('57300442115080407133202307056766732383')">Upvote</button>
          <span class="upvote-counter" id="57300442115080407133202307056766732383-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('57300442115080407133202307056766732383');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="188974766572862104319739902861124049019">
    <div id='188974766572862104319739902861124049019' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">ATP&#39;s Role in Cellular Stability</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"In a muscle cell, the presence of ATP stabilizes the muscle in its relaxed state, and in any cell, similar associations between ATP and proteins stabilize the cell in a basic resting condition in which it favors the presence of potassium over sodium."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- March 2020 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('188974766572862104319739902861124049019')">Upvote</button>
          <span class="upvote-counter" id="188974766572862104319739902861124049019-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('188974766572862104319739902861124049019');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="301922072699528938401676307653844662558">
    <div id='301922072699528938401676307653844662558' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Protein Interactions and Influence of Cardinal Adsorbents</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Everything that associates with a protein, such as potassium or ammonium, has an inductive effect on the protein’s structure and interactions with its surroundings, and substances that adsorb powerfully, especially ATP and steroids, have powerful influences on the properties of the system. Molecules that bind powerfully to proteins change the ways the proteins influence the properties of water, and the properties of water govern cells’ metabolism and their interactions with each other and with the environment. Ling called these influential binding molecules cardinal adsorbents."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- March 2020 - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('301922072699528938401676307653844662558')">Upvote</button>
          <span class="upvote-counter" id="301922072699528938401676307653844662558-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('301922072699528938401676307653844662558');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="273592869464158724100755655419778748600">
    <div id='273592869464158724100755655419778748600' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Biological Water Retention and Cell Energy Relations</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The retention of water by the living substance is a topic that reductionist biology has been reluctant to discuss. There are no pumps for biological water, and it took a long time for a water channel protein to be proposed. The structural molecules of a cell, its metabolites and water are mutually dissolved, and their affinity for each other is affected by the cell’s energetic relation to its environment. This mutual affinity is regulated by the balance of hormones and nutrients. ATP is a crucial factor in regulating the optimal state of water retention."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('273592869464158724100755655419778748600')">Upvote</button>
          <span class="upvote-counter" id="273592869464158724100755655419778748600-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('273592869464158724100755655419778748600');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="177557961839235912882538146617604141834">
    <div id='177557961839235912882538146617604141834' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Hypothyroidism Effects on Muscle Fatigue and Metabolites</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"When metabolic energy is failing, as in hypothyroidism, muscles become easily fatigued, and take up excess water, and the barrier structure is loosened, allowing macromolecules and ATP and other metabolites to leak out, while extraneous substances enter. Typical muscle enzymes such as lactate dehydrogenase and creatine kinase appear in the bloodstream in typical hypothyroid myopathy, and heart proteins, including a particular form of lactic dehydrogenase and a muscle protein, troponin, appear in the blood after a heart stress or fatigue combined with hypothyroidism or systemic inflammation."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('177557961839235912882538146617604141834')">Upvote</button>
          <span class="upvote-counter" id="177557961839235912882538146617604141834-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('177557961839235912882538146617604141834');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="15219926245200091052447543883290637335">
    <div id='15219926245200091052447543883290637335' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">ATP Leakage and Serotonin&#39;s Vicious Circle</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Any disruption of normal cell or tissue structure is recognized by the organism as a problem to be corrected; the appearance of ATP outside cells is a basic sign of damage and danger. Special enzymes degrade extracellular ATP into ADP, AMP, adenosine, and other purines, and these contribute to the alarm-stress signals. Increased synthesis of serotonin is one of the most important responses to leaked ATP and adenosine, but serotonin can increase the disorder of the actin system, increasing leakiness, in a vicious circle;"</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('15219926245200091052447543883290637335')">Upvote</button>
          <span class="upvote-counter" id="15219926245200091052447543883290637335-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('15219926245200091052447543883290637335');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="272564604503849124205732799315612386531">
    <div id='272564604503849124205732799315612386531' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">ATP and Tumor Growth Connection</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Extracellular ATP reaches a high level in tumors and becomes part of a self-stimulating growth promoting system."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('272564604503849124205732799315612386531')">Upvote</button>
          <span class="upvote-counter" id="272564604503849124205732799315612386531-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('272564604503849124205732799315612386531');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="340040559531768920340037929861557245969">
    <div id='340040559531768920340037929861557245969' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Spreading Damage Through Bystander Effects</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Severe stresses in one part of the body spread their influence through the body, in the process now called the bystander or off-target effect. Serotonin, nitric oxide, and ATP are among the substances that are known to spread damage"</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- September 2019 - Ray Peat&#39;s Newsletter </p>
        <button class="upvote-button" onclick="upvote('340040559531768920340037929861557245969')">Upvote</button>
          <span class="upvote-counter" id="340040559531768920340037929861557245969-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('340040559531768920340037929861557245969');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>
</p>

  </div>  
</div>


    </main>
    <footer>
      <footer class="footer fixed-bottom bg-dark">

    

  

  
  
  <script src="../js/bundle.min.js" defer></script>
      <script src="../js/main.f8356cbfc3b51bb24c286205b62461b46aaa5a219dac170a24f1692c6ff4154a.js" integrity="sha256-&#43;DVsv8O1G7JMKGIFtiRhtGqqWiGdrBcKJPFpLG/0FUo=" crossorigin="anonymous"></script>
</footer>
    </footer>
  </div>

  <script defer type="module">
    
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js';
    import { getFirestore, doc, onSnapshot, setDoc, updateDoc, increment, getDocs, collection, serverTimestamp, addDoc } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-firestore.js';
    import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-auth.js';


    const firebaseConfig = {
      apiKey: "AIzaSyBNTOHPQHCasjzKwje2P78-q6p1hsXQkW4",
      authDomain: "ray-peat-explained.firebaseapp.com",
      projectId: "ray-peat-explained",
      storageBucket: "ray-peat-explained.appspot.com",
      messagingSenderId: "791071522728",
      appId: "1:791071522728:web:3df2e0f7e4c0b66d4a679d"
    };


    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    async function signInAnonymouslyAndUpvote(upvote_id) {
      try {
        
        const userCredential = await signInAnonymously(auth);
        const user = userCredential.user;

        
        if (user) {
          console.log(`User is signed in anonymously with uid: ${user.uid}`);

          
          const upvoteData = {
            anonymousUserId: user.uid,
            upvote_id: upvote_id,
            timeOfUpvote: serverTimestamp(),
          };

          
          const docRef = await addDoc(collection(db, "upvotes"), upvoteData);
          console.log("Document written with ID: ", docRef.id);
        } else {
          console.log("User sign-in failed");
        }
      } catch (error) {
        const errorCode = error.code;
        const errorMessage = error.message;
        console.error(`Error code: ${errorCode}, Message: ${errorMessage}`);
      }
    }

    
    function setUpQuoteListener(quoteId) {
      const quoteRef = doc(db, "quotes", quoteId);

      onSnapshot(quoteRef, (docSnapshot) => {
        const upvotesSpan = document.getElementById(`${quoteId}-count`);
        if (docSnapshot.exists()) {
          upvotesSpan.textContent = docSnapshot.data().upvotes;
        } else {
          
          setDoc(quoteRef, { upvotes: 0 })
            .then(() => { upvotesSpan.textContent = "0"; })
            .catch((error) => {
              console.error("Error creating document: ", error);
            });
        }
      });
    }

    
    function upvote(quoteId) {
      const quoteRef = doc(db, "quotes", quoteId);

      
      updateDoc(quoteRef, {
        upvotes: increment(1)
      }).catch((error) => {
        console.error("Error updating document: ", error);
      });

      signInAnonymouslyAndUpvote(quoteId).catch((error) => {
        console.error("Error updating document II: ", error);
      });

    }

    
    window.upvote = upvote;

    
    document.addEventListener('DOMContentLoaded', () => {
      
      const quoteContainers = document.querySelectorAll('.quote-container');

      
      quoteContainers.forEach(container => {
        const quoteId = container.id;
        setUpQuoteListener(quoteId);
      });
    });

    document.getElementById("sort-by-popularity").addEventListener('click', async () => {
      try {
        
        const querySnapshot = await getDocs(collection(db, 'quotes'));
        const upvotesMap = new Map();  

        querySnapshot.forEach(doc => {
          
          upvotesMap.set(doc.id, doc.data().upvotes);
        });

        
        const quoteElems = document.querySelectorAll('.quote');

        
        quoteElems.forEach(quoteElem => {
          const quoteId = quoteElem.getAttribute('data-quote-id');
          const upvotes = upvotesMap.get(quoteId) || 0; 
          quoteElem.setAttribute('data-upvotes', upvotes);
        });

        
        const quoteArray = Array.from(quoteElems);
        quoteArray.sort((a, b) => {
          return b.getAttribute('data-upvotes') - a.getAttribute('data-upvotes');
        });

        
        const quotesContainer = document.getElementById('quotesContainer');
        quotesContainer.innerHTML = ''; 

        
        quoteArray.forEach(quote => {
          quotesContainer.appendChild(quote);
        });
      } catch (err) {
        console.error('Error fetching upvotes: ', err);
      }
    });

    window.copyLinkToClipboard = function copyLinkToClipboard(id) {
      
      const urlWithHash = `${window.location.href.split('#')[0]}#${id}`;
    
      
      navigator.clipboard.writeText(urlWithHash).then(() => {
        
      }).catch(err => {
        console.error("Could not copy text: ", err);
      });
    }

    window.highlightDiv=  function highlightDiv(hash) {
      
      document.querySelectorAll('.highlight-quote').forEach((el) => {
        el.classList.remove('highlight-quote');
      });
    
      
      if (hash !== '') {
        const id = hash.replace('#', '');
        const divToHighlight = document.getElementById(id);
        if (divToHighlight) {
          divToHighlight.classList.add('highlight-quote');
          console.log("Quote selected")
    
          
          divToHighlight.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      }
    }
    
    
    window.addEventListener('hashchange', () => window.highlightDiv(window.location.hash));
    window.addEventListener('DOMContentLoaded', () => window.highlightDiv(window.location.hash));
    
  </script>

</body>

</html>