<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

<head>
  <head>
    <script defer src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>


    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4F8KTHDP9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-4F8KTHDP9M');
    </script>
    
    
    
    <title>Ray Peat on menopause</title>
    <meta charset="utf-8">
    <meta name="description" content="Explore the wisdom of Ray Peat by topics    " />
    <meta name="dc.relation" content="https://raypeatexplained.com" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#1A94D2" />

    

    
    <link rel="stylesheet" href="../css/styles.min.css" media="screen">

    
    <link rel='shortcut icon' type='image/x-icon' href='../favicon.ico' />
    
    <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore-compat.js"></script>

    <style>
         
        .search-box {
            margin-bottom: 20px;
            text-align: center;
        }

        .search-box input {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            min-width: calc(50% - 20px);
             
        }

        .highlight {
            background-color: yellow;
             
        }
    </style>

</head>
</head>

<body>


  <header class="">
          <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="https://raypeatexplained.com/">Ray Peat Explained</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link  " href="https://raypeatexplained.com/">Home</a>              </li>

              
              
          </div>
        </div>
      </nav>

  </header>
  <div class="container-fluid">
    <main>
      


<div class="container pb-5 mt-4">
  <h1 class="mb-3" style="text-transform: capitalize;">Ray Peat on menopause</h1>
  
  
  
  
  <div class="search-box">
    <button class="btn btn-primary" id="sort-by-popularity">Sort by popularity</button>

    <input type="text" id="quoteSearch" placeholder="Search quotes...">
  </div>

 

  


  <div id="quotesContainer"> 
  <p>
<div class="quote"  data-upvotes="0" data-quote-id="113818058645314401302413599740082026538">
    <div id='113818058645314401302413599740082026538' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Progesterone&#39;s Role in Various Medical Conditions</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"While progesterone might seem to cure almost everything, we should be careful to use it only when the biochemical mechanism is fairly evident. A progesterone deficiency can be misdiagnosed, as (for example) epilepsy, Brights disease, multiple sclerosis, or even estrogen deficiency (as in menopause). It can affect susceptibility to many conditions including herpes infections, dizziness, dysperception, varicose veins, mastitis, fibroma, and endometriosis. Cyclic edema, depression, and migraine are, in my experience, always stopped by progesterone."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- Nutrition For Women </p>
        <button class="upvote-button" onclick="upvote('113818058645314401302413599740082026538')">Upvote</button>
          <span class="upvote-counter" id="113818058645314401302413599740082026538-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('113818058645314401302413599740082026538');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="22839480341798112712755204760064489165">
    <div id='22839480341798112712755204760064489165' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Dalton&#39;s Findings on Menopause and Hormonal Imbalance</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Katharina Dalton has found that premenstrual symptoms, which result from a relative estrogen surplus and a progesterone deficiency, often continue during the menopause"</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- Nutrition For Women </p>
        <button class="upvote-button" onclick="upvote('22839480341798112712755204760064489165')">Upvote</button>
          <span class="upvote-counter" id="22839480341798112712755204760064489165-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('22839480341798112712755204760064489165');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="303463509710699275140014962402647285599">
    <div id='303463509710699275140014962402647285599' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Menopause Symptoms and Progesterone Deficiency</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Strickler found that only 10% of his patients with menopausal symptoms such as flushing, could feel and benefit from estrogen when it was alternated with a placebo. These studies, and a few dozen others, have convinced me that the symptoms of menopause result mainly from a progesterone deficiency, relative to the estrogens. The 10% who really feel better from estrogen possibly have an estrogen deficiency, but this has not been determined, and several other things could account for the lift they feel for example, a healthy thyroid gland will respond to elevated estrogen with an increased output of thyroxin, which at least would make the person feel different, and might raise blood sugar, increase alertness, etc."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- Nutrition For Women </p>
        <button class="upvote-button" onclick="upvote('303463509710699275140014962402647285599')">Upvote</button>
          <span class="upvote-counter" id="303463509710699275140014962402647285599-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('303463509710699275140014962402647285599');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="80750066184803998586286323227170539573">
    <div id='80750066184803998586286323227170539573' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Osteoporosis, Diabetes, and Mineral Loss Linked to Cortisone</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Osteoporosis and diabetes are frequently part of Cushings syndrome, and are also more common after the menopause. Cortisone therapy (even when used on the skin) can cause mineral loss"</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- Nutrition For Women </p>
        <button class="upvote-button" onclick="upvote('80750066184803998586286323227170539573')">Upvote</button>
          <span class="upvote-counter" id="80750066184803998586286323227170539573-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('80750066184803998586286323227170539573');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="325526597384936642862470569312632673689">
    <div id='325526597384936642862470569312632673689' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Insights from Overlapping Conditions on Stress and Aging</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Aging, stress, menopause, Cushings syndrome, and the premenstrual syndrome all overlap so much that each state can probably give us some insight into the others."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- Nutrition For Women </p>
        <button class="upvote-button" onclick="upvote('325526597384936642862470569312632673689')">Upvote</button>
          <span class="upvote-counter" id="325526597384936642862470569312632673689-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('325526597384936642862470569312632673689');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="109598692737849823563816311858492196929">
    <div id='109598692737849823563816311858492196929' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Cortisol Levels and Inflammation Post-Menopause</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Starting suddenly around the time of menopause, cortisol is higher, probably as compensation for the lost stabilizing effects of progesterone, and the increased inflammatory processes resulting from lower body temperature."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- November 2020 - Ray Peat&#39;s Newsletter  </p>
        <button class="upvote-button" onclick="upvote('109598692737849823563816311858492196929')">Upvote</button>
          <span class="upvote-counter" id="109598692737849823563816311858492196929-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('109598692737849823563816311858492196929');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="7936127522035676046568452303433891415">
    <div id='7936127522035676046568452303433891415' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Aromatase Activity and Hormonal Impact at Menopause</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Aromatase, the enzyme that produces estrogen, is present in muscles, fat, blood vessels, and many other tissues, and its activity is increased by cortisol, and decreased by progesterone. The changed activity of these two steroids at menopause can account for the sudden increase in the degenerative diseases, inflammation, depression, etc."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- November 2020 - Ray Peat&#39;s Newsletter  </p>
        <button class="upvote-button" onclick="upvote('7936127522035676046568452303433891415')">Upvote</button>
          <span class="upvote-counter" id="7936127522035676046568452303433891415-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('7936127522035676046568452303433891415');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="4583847819073069900332072214719871609">
    <div id='4583847819073069900332072214719871609' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Menopause&#39;s Impact on Respiratory and Circulatory Health</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Respiratory and circulatory problems increase with menopause, corresponding to increases in inflammatory cytokines and cortisol, and decreases in progesterone and thyroid hormone. Both thyroid and progesterone are thermogenic, and lower estrogen levels."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- November 2020 - Ray Peat&#39;s Newsletter  </p>
        <button class="upvote-button" onclick="upvote('4583847819073069900332072214719871609')">Upvote</button>
          <span class="upvote-counter" id="4583847819073069900332072214719871609-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('4583847819073069900332072214719871609');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="281345241176793361397412718314254121227">
    <div id='281345241176793361397412718314254121227' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Estrogen Levels and Antiestrogenic Factors in Reproduction</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"The actual level of estrogen rises all through the reproductive years, and at menopause, the reduction in antiestrogenic factors, such as progesterone, thyroid, and DHEA, leads to increased effects of estrogen."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- 2001 - February</p>
        <button class="upvote-button" onclick="upvote('281345241176793361397412718314254121227')">Upvote</button>
          <span class="upvote-counter" id="281345241176793361397412718314254121227-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('281345241176793361397412718314254121227');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="318243452133109510471568058247904435489">
    <div id='318243452133109510471568058247904435489' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Uniform Opinion and Its Impact on Publishing Trends</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Uniformity of opinion creates an environment in which publishers who want to sell a lot of books feel that they have to publish things that don’t disturb the reading public. Books about menopause become bocks about an attitude toward menopause."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- 1995 - August.September - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('318243452133109510471568058247904435489')">Upvote</button>
          <span class="upvote-counter" id="318243452133109510471568058247904435489-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('318243452133109510471568058247904435489');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="224382758253853787569793795107060098300">
    <div id='224382758253853787569793795107060098300' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Debunking Menopause Myths: Ovary Function and Hormone Production</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Even people who like to say that the ovaries don’t fail at menopause describe a theory in which menopause and its consequences are the result of the disappearance of eggs from the ovary. That theory is so simple it can be described in three short sentences, none of which is true: (1) ovary runs out of eggs; (2) ovulation produces hormones, so you can tell when ovulation stops because the ovaries stop producing hormones; (3) menstruation stops because ovulation has stopped. Those principles are surrounded by various corollaries. Estrogen is the female hormone. Estrogen deficiency accelerates aging. Treatment with estrogen makes you more feminine. Progesterone deficiency is the result of anovulatary cycles."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- 1995 - August.September - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('224382758253853787569793795107060098300')">Upvote</button>
          <span class="upvote-counter" id="224382758253853787569793795107060098300-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('224382758253853787569793795107060098300');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="228230848955304645239857795140170865789">
    <div id='228230848955304645239857795140170865789' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Stress, Estrogen, and Brain&#39;s Role in Menopause and Aging</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"Stress, especially when augmented by estrogen, leads to injury, exhaustion, and aging. The uterus and ovaries participate in the response to stress, but (as Zeilmaker and Wise have shown) the brain proves to be more directly involved in menopause than the ovaries or uterus. Coordination turns out to be crucial for complex processes such as ovulation, fertilization, and implantation. The destruction of the nerve cells that regulate the pituitary makes coordination impossible."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- 1995 - August.September - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('228230848955304645239857795140170865789')">Upvote</button>
          <span class="upvote-counter" id="228230848955304645239857795140170865789-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('228230848955304645239857795140170865789');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="191720088802755319533015550836966635880">
    <div id='191720088802755319533015550836966635880' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Estrogen Excess, Androgens, and Defeminization at Menopause</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"At menopause, estrogen excess can promote the production of androgens, in the absence of progesterone, which tends ta defeminize the woman. This is often a result of stress, and sometimes is a consequence of hypothyroidism. In situations of this sort, estrogen is seen not to be a feminizing hormone; it is unable to neutralize the male hormones the body produces in response to the estrogen excess."</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- 1995 - August.September - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('191720088802755319533015550836966635880')">Upvote</button>
          <span class="upvote-counter" id="191720088802755319533015550836966635880-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('191720088802755319533015550836966635880');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>


<div class="quote"  data-upvotes="0" data-quote-id="10300741868940548701323596677934277869">
    <div id='10300741868940548701323596677934277869' class="quote-container" style="margin: 10px; padding: 5px; background-color: #f9f9f9; border-left: 4px solid #5a5a5a;">
        <b style="font-style: italic; color: #333;">Menopause and Cushing’s Syndrome Symptom Parallels</b>
        <p style="margin-bottom: 10px; font-size: 18px; color: #555;">"In the mid-1970s when I pointed out that menopause resembles Cushing’s syndrome I hadn’t investigated that disease of cortisol-excess enough to know the full extent of the parallel: for example, hot flushes, night sweats, and insomnia, such common menopausal symptoms, are also common symptoms in Cushing’s syndrome. Estrogen’s tendency to increase cortisol production should be considered in connection with the brain-aging effects of both estrogen and cortisol"</p>
        <p style="font-size: 16px; text-align: right; color: #777;">- 1991 - April - Ray Peat&#39;s Newsletter</p>
        <button class="upvote-button" onclick="upvote('10300741868940548701323596677934277869')">Upvote</button>
          <span class="upvote-counter" id="10300741868940548701323596677934277869-count">0</span> upvotes
          <button class="btn btn-primary" onclick="copyLinkToClipboard('10300741868940548701323596677934277869');">Copy Link to Quote</button>
    </div>
    
    <hr style="border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));">
</div>
</p>

  </div>  
</div>


    </main>
    <footer>
      <footer class="footer fixed-bottom bg-dark">

    

  

  
  
  <script src="../js/bundle.min.js" defer></script>
      <script src="../js/main.f8356cbfc3b51bb24c286205b62461b46aaa5a219dac170a24f1692c6ff4154a.js" integrity="sha256-&#43;DVsv8O1G7JMKGIFtiRhtGqqWiGdrBcKJPFpLG/0FUo=" crossorigin="anonymous"></script>
</footer>
    </footer>
  </div>

  <script defer type="module">
    
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js';
    import { getFirestore, doc, onSnapshot, setDoc, updateDoc, increment, getDocs, collection, serverTimestamp, addDoc } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-firestore.js';
    import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.1.0/firebase-auth.js';


    const firebaseConfig = {
      apiKey: "AIzaSyBNTOHPQHCasjzKwje2P78-q6p1hsXQkW4",
      authDomain: "ray-peat-explained.firebaseapp.com",
      projectId: "ray-peat-explained",
      storageBucket: "ray-peat-explained.appspot.com",
      messagingSenderId: "791071522728",
      appId: "1:791071522728:web:3df2e0f7e4c0b66d4a679d"
    };


    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    async function signInAnonymouslyAndUpvote(upvote_id) {
      try {
        
        const userCredential = await signInAnonymously(auth);
        const user = userCredential.user;

        
        if (user) {
          console.log(`User is signed in anonymously with uid: ${user.uid}`);

          
          const upvoteData = {
            anonymousUserId: user.uid,
            upvote_id: upvote_id,
            timeOfUpvote: serverTimestamp(),
          };

          
          const docRef = await addDoc(collection(db, "upvotes"), upvoteData);
          console.log("Document written with ID: ", docRef.id);
        } else {
          console.log("User sign-in failed");
        }
      } catch (error) {
        const errorCode = error.code;
        const errorMessage = error.message;
        console.error(`Error code: ${errorCode}, Message: ${errorMessage}`);
      }
    }

    
    function setUpQuoteListener(quoteId) {
      const quoteRef = doc(db, "quotes", quoteId);

      onSnapshot(quoteRef, (docSnapshot) => {
        const upvotesSpan = document.getElementById(`${quoteId}-count`);
        if (docSnapshot.exists()) {
          upvotesSpan.textContent = docSnapshot.data().upvotes;
        } else {
          
          setDoc(quoteRef, { upvotes: 0 })
            .then(() => { upvotesSpan.textContent = "0"; })
            .catch((error) => {
              console.error("Error creating document: ", error);
            });
        }
      });
    }

    
    function upvote(quoteId) {
      const quoteRef = doc(db, "quotes", quoteId);

      
      updateDoc(quoteRef, {
        upvotes: increment(1)
      }).catch((error) => {
        console.error("Error updating document: ", error);
      });

      signInAnonymouslyAndUpvote(quoteId).catch((error) => {
        console.error("Error updating document II: ", error);
      });

    }

    
    window.upvote = upvote;

    
    document.addEventListener('DOMContentLoaded', () => {
      
      const quoteContainers = document.querySelectorAll('.quote-container');

      
      quoteContainers.forEach(container => {
        const quoteId = container.id;
        setUpQuoteListener(quoteId);
      });
    });

    document.getElementById("sort-by-popularity").addEventListener('click', async () => {
      try {
        
        const querySnapshot = await getDocs(collection(db, 'quotes'));
        const upvotesMap = new Map();  

        querySnapshot.forEach(doc => {
          
          upvotesMap.set(doc.id, doc.data().upvotes);
        });

        
        const quoteElems = document.querySelectorAll('.quote');

        
        quoteElems.forEach(quoteElem => {
          const quoteId = quoteElem.getAttribute('data-quote-id');
          const upvotes = upvotesMap.get(quoteId) || 0; 
          quoteElem.setAttribute('data-upvotes', upvotes);
        });

        
        const quoteArray = Array.from(quoteElems);
        quoteArray.sort((a, b) => {
          return b.getAttribute('data-upvotes') - a.getAttribute('data-upvotes');
        });

        
        const quotesContainer = document.getElementById('quotesContainer');
        quotesContainer.innerHTML = ''; 

        
        quoteArray.forEach(quote => {
          quotesContainer.appendChild(quote);
        });
      } catch (err) {
        console.error('Error fetching upvotes: ', err);
      }
    });

    window.copyLinkToClipboard = function copyLinkToClipboard(id) {
      
      const urlWithHash = `${window.location.href.split('#')[0]}#${id}`;
    
      
      navigator.clipboard.writeText(urlWithHash).then(() => {
        
      }).catch(err => {
        console.error("Could not copy text: ", err);
      });
    }

    window.highlightDiv=  function highlightDiv(hash) {
      
      document.querySelectorAll('.highlight-quote').forEach((el) => {
        el.classList.remove('highlight-quote');
      });
    
      
      if (hash !== '') {
        const id = hash.replace('#', '');
        const divToHighlight = document.getElementById(id);
        if (divToHighlight) {
          divToHighlight.classList.add('highlight-quote');
          console.log("Quote selected")
    
          
          divToHighlight.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      }
    }
    
    
    window.addEventListener('hashchange', () => window.highlightDiv(window.location.hash));
    window.addEventListener('DOMContentLoaded', () => window.highlightDiv(window.location.hash));
    
  </script>

</body>

</html>